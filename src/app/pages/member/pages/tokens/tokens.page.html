<nz-card *ngIf="deviceService.isDesktop$ | async">
    <nz-table class="block"
        [nzData]="(tokens$ | async) || []" [nzShowPagination]="false">
        <thead>
            <tr>
                <th i18n>Item</th>
                <th i18n>Type</th>
                <th i18n>Total</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <ng-container *ngFor="let t of modifiedTokens$ | async">
              <ng-container *ngIf="!helper.isMinted(t)">
                  <!-- PRE MINTED  -->
                  <tr *ngIf="t.distribution.tokenOwned">
                      <td [routerLink]="helper.preMinted(t) ? ['/token', t.uid, 'trade'] : ['/token', t.uid]" class="cursor-pointer">
                          <div class="flex items-center">
                              <nz-avatar [nzSrc]="previewImageService.getAvatarSize(t.icon)"
                                class="border-2 border-tags-border dark:border-tags-border-dark min-w-8"
                                nzShape="circle"
                                [nzSize]="32">
                              </nz-avatar>
                              <div class="ml-3 text-lg font-bold text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ t.name }}</div>
                          </div>
                      </td>
                      <td class="font-medium" i18n>Owned</td>
                      <td class="font-medium">{{ (helper.formatTokenBest(t.distribution.tokenOwned) | number: '1.0-6') + ' ' + t.symbol  }}</td>
                      <td class="right"></td>
                  </tr>

                  <ng-container *ngIf="t.distribution.tokenDrops?.length">
                      <tr *ngFor="let drop of t.distribution.tokenDrops">
                        <td [routerLink]="helper.preMinted(t) ? ['/token', t.uid, 'trade'] : ['/token', t.uid]" class="cursor-pointer">
                          <div class="flex items-center">
                              <nz-avatar [nzSrc]="previewImageService.getAvatarSize(t.icon)"
                                class="border-2 border-tags-border dark:border-tags-border-dark min-w-8"
                                nzShape="circle"
                                [nzSize]="32">
                              </nz-avatar>
                              <div class="ml-3 text-lg font-bold text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ t.name }}</div>
                          </div>
                        </td>
                        <td class="font-medium">
                            <div class="flex items-center">
                                <ng-container i18n>Airdropped</ng-container>
                                <ng-container *ngIf="helper.vestingInFuture(drop)">
                                    (<ng-container i18n>from</ng-container> {{ drop.vestingAt.toDate() | date: 'shortDate' }})
                                </ng-container>
                            </div>
                        </td>
                        <td class="font-medium">{{ ((helper.formatTokenBest(drop.count) | number: '1.0-6') + ' ' + t.symbol)  }}</td>
                        <td class="right">
                            <button *ngIf="((data.member$ | async)?.uid === (loggedInMember$ | async)?.uid)"
                                class="font-medium underline text-buttons-primary-enabled dark:text-buttons-primary-enabled-dark"
                                (click)="claim(t, drop)">
                                    {{ tokenActionTypeLabels[tokenItemTypes.CLAIM] }}
                            </button>
                        </td>
                      </tr>
                  </ng-container>
              </ng-container>

              <ng-container *ngIf="helper.isMinted(t) && !t.distribution.mintedClaimedOn">
                <tr>
                  <td [routerLink]="helper.preMinted(t) ? ['/token', t.uid, 'trade'] : ['/token', t.uid]" class="cursor-pointer">
                    <div class="flex items-center">
                        <nz-avatar [nzSrc]="previewImageService.getAvatarSize(t.icon)"
                          class="border-2 border-tags-border dark:border-tags-border-dark min-w-8"
                          nzShape="circle"
                          [nzSize]="32">
                        </nz-avatar>
                        <div class="ml-3 text-lg font-bold text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ t.name }}</div>
                    </div>
                  </td>
                  <td class="font-medium">
                      <div class="flex items-center">
                          <ng-container i18n>Owned</ng-container>
                      </div>
                  </td>
                  <td class="font-medium">{{ ((helper.formatTokenBest((t.distribution.tokenOwned || 0) + (t.distribution.tokenDrops?.[0]?.count || 0)) | number: '1.0-6') + ' ' + t.symbol)  }}</td>
                  <td class="right">
                      <button *ngIf="((data.member$ | async)?.uid === (loggedInMember$ | async)?.uid)"
                          class="font-medium underline text-buttons-primary-enabled dark:text-buttons-primary-enabled-dark"
                          (click)="claim(t)">
                              {{ tokenActionTypeLabels[tokenItemTypes.CLAIM] }}
                      </button>
                  </td>
                </tr>
            </ng-container>


              <tr *ngIf="helper.salesInProgressOrUpcoming(t) && t.distribution.totalDeposit">
                <td [routerLink]="helper.preMinted(t) ? ['/token', t.uid, 'trade'] : ['/token', t.uid]" class="cursor-pointer">
                  <div class="flex items-center">
                      <nz-avatar [nzSrc]="previewImageService.getAvatarSize(t.icon)"
                        class="border-2 border-tags-border dark:border-tags-border-dark min-w-8"
                        nzShape="circle"
                        [nzSize]="32">
                      </nz-avatar>
                      <div class="ml-3 text-lg font-bold text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ t.name }}</div>
                  </div>
                </td>
                <td class="font-medium" i18n>Deposit for purchase</td>
                <td class="font-medium">{{ helper.formatBest(t.distribution.totalDeposit) }}</td>
                <td class="right">
                    <button  *ngIf="((data.member$ | async)?.uid === (loggedInMember$ | async)?.uid) && helper.isInCooldown(t)"
                        class="font-medium underline text-buttons-primary-enabled dark:text-buttons-primary-enabled-dark"
                        (click)="openTokenRefund = t">
                            {{ tokenActionTypeLabels[tokenItemTypes.REFUND] }}
                    </button>
                </td>
              </tr>

            </ng-container>
        </tbody>
    </nz-table>
</nz-card>


<div class="mt-3" *ngIf="deviceService.isMobile$ | async">
    <p nz-typography nzType="secondary" class="mb-6" *ngIf="!isLoading(tokens$ | async)">
      {{ ((tokens$ | async)?.length || 0) + ((maxRecords$ | async) === false ? '+' : '') }} NFTs
    </p>
    <div class="mb-10" infiniteScroll [infiniteScrollDistance]="5" [infiniteScrollThrottle]="50"
        (scrolled)="onScroll()">

        <nz-skeleton *ngIf="isLoading(tokens$ | async)" class="p-4 bg-backgrounds-tertiary dark:bg-backgrounds-tertiary-dark rounded-2xl w-76 lg:w-full h-76 lg:h-16" [nzActive]="true"
            [nzAvatar]="{ size: 'default' }" [nzParagraph]="{ rows: 1 }"></nz-skeleton>

        <nz-card class="w-76" *ngIf="isEmpty(tokens$ | async)">
            <div class="flex flex-col justify-center text-center h-36">
                <span class="leading-7 text-foregrounds-secondary dark:text-foregrounds-secondary-dark" i18n>
                    No tokens
                </span>
            </div>
        </nz-card>

        <wen-token-row *ngFor="let token of tokens$ | async; trackBy: trackByUid" [token]="token" class="block mt-3">
        </wen-token-row>
    </div>
</div>

<wen-token-refund *ngIf="!!openTokenRefund" [isOpen]="!!openTokenRefund" [token]="openTokenRefund" [memberDistribution]="openTokenRefund.distribution" (wenOnClose)="openTokenRefund = null"></wen-token-refund>
<wen-token-claim *ngIf="!!openTokenClaim" [isOpen]="!!openTokenClaim" [token]="openTokenClaim" [drop]="tokenDrop" [memberDistribution]="openTokenClaim.distribution" (wenOnClose)="openTokenClaim = null"></wen-token-claim>
