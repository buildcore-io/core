<wen-content [showBackButton]="(deviceService.isDesktop$ | async) || false">
  <ng-container *ngIf="deviceService.isMobile$ | async">
    <wen-drawer-toggle
      label="About space"
      (click)="isAboutSpaceVisible = true">
    </wen-drawer-toggle>

    <wen-fixed-create-button
      [route]="urlToNewSpace"
    ></wen-fixed-create-button>
  </ng-container>
  

  <div class="absolute top-18 lg:top-0 left-0 lg:right-0 w-auto overflow-hidden h-56 lg:h-96 rounded-10 lg:rounded-large lg:rounded-r-none lg:left-20">
    <img alt="" [src]="(bannerUrl$ | async) || '/assets/mocks/no_banner.jpg'" class="object-cover w-full h-full" />
  </div>

  <div class="relative py-12 mt-48 lg:mt-80 w-full lg:w-auto" nz-row [nzGutter]="40" *ngIf="(data.space$ | async)">
    <nz-avatar [nzSrc]="(avatarUrl$ | async) || undefined" [nzSize]="(deviceService.isDesktop$ | async) ? 120 : 80"
      class="absolute top-0 -mt-8 transform -translate-y-1/2 bg-white border-2 border-gray-400 left-4" nzShape="circle">
    </nz-avatar>

    <div class="mx-5 lg:mx-0 my-0 p-0 lg:px-5 flex-auto" [ngStyle]="{
      'max-width': (deviceService.isDesktop$ | async) ? 'calc(100% - 450px)' : '100%'
    }">
      <h1 class="mb-8 lg:mb-10" i18n>{{ (data.space$ | async)!.name }}</h1>

      <div *ngIf="deviceService.isMobile$ | async" class="mb-14">
        <button nz-button nzType="primary" (click)="join()" nzBlock nzSize="large" i18n
          *ngIf="(data.isMemberWithinSpace$ | async) === false && (member$ | async) && (data.space$ | async)!.open !== false">
          Join Space
        </button>

        <button nz-button nzType="primary" (click)="join()" nzBlock nzSize="large"
          [disabled]="(data.isPendingMemberWithSpace$ | async) === true"
          *ngIf="(data.isMemberWithinSpace$ | async) === false && (member$ | async) && (data.space$ | async)!.open === false">
          {{(data.isPendingMemberWithSpace$ | async) === true ? 'Pending Request' :
          'Ask to Join Space'}}
        </button>
        <div>
          <button nz-button nzBlock nzSize="large" *ngIf="data.isGuardianWithinSpace$ | async" (click)="edit()" i18n>
            Edit Space
          </button>
        </div>
      </div>
      

      <wen-tabs [tabs]="sections" class="block w-full lg:w-auto overflow-x-auto overflow-y-hidden"></wen-tabs>

      <div class="w-full py-14 lg:py-12">
        <router-outlet></router-outlet>
      </div>
    </div>
    <div class="space-y-4" nz-col nzFlex="450px" style="max-width: 450px;" *ngIf="deviceService.isDesktop$ | async">
      <button nz-button nzType="primary" (click)="join()" nzBlock nzSize="large" i18n
        *ngIf="(data.isMemberWithinSpace$ | async) === false && (member$ | async) && (data.space$ | async)!.open !== false">
        Join Space
      </button>

      <button nz-button nzType="primary" (click)="join()" nzBlock nzSize="large"
        [disabled]="(data.isPendingMemberWithSpace$ | async) === true"
        *ngIf="(data.isMemberWithinSpace$ | async) === false && (member$ | async) && (data.space$ | async)!.open === false">
        {{(data.isPendingMemberWithSpace$ | async) === true ? 'Pending Request' :
        'Ask to Join Space'}}
      </button>
      <div>
        <button nz-button nzBlock nzSize="large" *ngIf="data.isGuardianWithinSpace$ | async" (click)="edit()" i18n>
          Edit Space
        </button>
      </div>

      <wen-space-about 
        [avatarUrl]="(avatarUrl$ | async) || undefined"
        [space]="data.space$ | async"
        [guardians$]="data.guardians$"
        [isMemberWithinSpace]="data.isMemberWithinSpace$ | async"
        [getMemberUrl]="getMemberUrl"
        [trackByUid]="trackByUid"
        (onLeave)="leave()"
      ></wen-space-about>
    </div>
  </div>

  <nz-drawer
        [nzBodyStyle]="{ overflow: 'auto', padding: '8px' }"
        [nzWidth]="'100vw'"
        [nzClosable]="false"
        [nzVisible]="isAboutSpaceVisible"
      >
      <div *nzDrawerContent class="relative h-full">
        <button class="absolute -top-0 right-5 z-10" (click)="isAboutSpaceVisible = false">
          <wen-icon-close></wen-icon-close>
        </button>

        <wen-space-about 
          [avatarUrl]="(avatarUrl$ | async) || undefined"
          [space]="data.space$ | async"
          [guardians$]="data.guardians$"
          [isMemberWithinSpace]="data.isMemberWithinSpace$ | async"
          [getMemberUrl]="getMemberUrl"
          [trackByUid]="trackByUid"
          (onLeave)="leave()"
        ></wen-space-about>
      </div>
  </nz-drawer>
</wen-content>
