<div class="flex items-center pt-10 mt-8 lg:pt-0">
    <a nz-button nzType="default" nzSize="default" target="_new"
        *ngIf="(data.collection$ | async)?.url" [href]="(data.collection$ | async)?.url"
        class="flex items-center justify-center grow w-1/2 mr-2 lg:mr-4 wen-link-padding"
        [ngClass]="{ 'border-buttons-primary-enabled dark:border-buttons-primary-enabled-dark': deviceService.isMobile$ | async }">
            <wen-icon-github></wen-icon-github>
            <div class="ml-2.5 text-xs font-medium" i18n>Visit website</div>
    </a>
    <a nz-button nzType="default" nzSize="default" target="_new"
        [href]="helper.getShareUrl(data.collection$ | async)"
        class="flex items-center justify-center grow w-1/2 wen-link-padding"
        [ngClass]="{ 'border-buttons-primary-enabled dark:border-buttons-primary-enabled-dark': deviceService.isMobile$ | async }">
            <wen-icon-share></wen-icon-share>
            <div class="ml-2.5 text-xs font-medium" i18n>Share</div>
    </a>
</div>

<nz-card class="mt-8" i18n-nzTitle nzTitle="Network">
  <ng-container *ngIf="!helper.isMinted(data.collection$ | async)">
      <div class="font-medium text-sm text-foregrounds-secondary dark:text-foregrounds-secondary-dark mb-6"
        *ngIf="(isGuardianWithinSpace$ | async) && (data.collection$ | async)?.approved === true" i18n>
        Make NFTâ€™s from this collection available on decentralised network.
      </div>

      <button nz-button nzType="primary" nzSize="default" class="w-full"
        *ngIf="(isGuardianWithinSpace$ | async) && !helper.isMinted(data.collection$ | async) && (data.collection$ | async)?.approved === true"
        [disabled]="helper.mintInProgress(data.collection$ | async)"
        (click)="isMintOnNetorkVisible = true">
          <ng-container *ngIf="helper.mintInProgress(data.collection$ | async); else mintText">
            <span i18n>Minting</span>
            <ng-container *ngIf="((data.collection$ | async)?.mintingData?.nftsToMint || 0) > 0">
              &nbsp;({{(data.collection$ | async)?.mintingData?.nftsToMint | number}}&nbsp;<span i18n>NFTs left</span>...)
            </ng-container>
          </ng-container>
          <ng-template #mintText i18n>Mint Collection</ng-template>
      </button>

      <div class="font-medium" *ngIf="!helper.isMinted(data.collection$ | async) &&
        ((isGuardianWithinSpace$ | async) === false || (data.collection$ | async)?.approved !== true)" i18n>
          Collection is not yet migrated to the decentralized network.
      </div>
  </ng-container>

  <div *ngIf="helper.isMinted(data.collection$ | async)">
    <a class="flex items-center px-4 py-3 w-full font-medium cursor-pointer rounded-xl bg-backgrounds-secondary dark:bg-backgrounds-secondary-dark"
        [href]="helper.getExplorerUrl(data.collection$ | async)" target="_blank">
        <ng-container [ngSwitch]="(data.collection$ | async)?.mintingData?.network">
            <ng-container *ngSwitchCase="networkTypes.SMR">
                <wen-icon-shimmer [size]="20"></wen-icon-shimmer>
                <div class="ml-2 w-max" i18n>Shimmer</div>
            </ng-container>
            <ng-container *ngSwitchCase="networkTypes.RMS">
                <wen-icon-shimmer [size]="20"></wen-icon-shimmer>
                <div class="ml-2 w-max" i18n>Shimmer Testnet</div>
            </ng-container>
            <ng-container *ngSwitchCase="networkTypes.IOTA">
                <wen-icon-iota [size]="20"></wen-icon-iota>
                <div class="ml-2 w-max" i18n>IOTA</div>
            </ng-container>
            <ng-container *ngSwitchCase="networkTypes.ATOI">
                <wen-icon-iota [size]="20"></wen-icon-iota>
                <div class="ml-2 w-max" i18n>IOTA Devnet</div>
            </ng-container>
        </ng-container>
    </a>
  </div>
</nz-card>

<nz-card class="mt-4" i18n-nzTitle nzTitle="Who can buy?">
  <div class="flex" *ngIf="(data.collection$ | async)?.access === access.OPEN">
    <wen-icon-open-sale [size]="20" class="text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-open-sale>
    <div class="ml-1.5 text-sm font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark" i18n>
      Open sale
    </div>
  </div>
  <div class="flex" *ngIf="(data.collection$ | async)?.access === access.MEMBERS_ONLY">
    <wen-icon-members-only [size]="20" class="text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-members-only>
    <div class="ml-1.5 text-sm font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark" i18n>
      Space Members Only
    </div>
  </div>
  <div class="flex" *ngIf="(data.collection$ | async)?.access === access.GUARDIANS_ONLY">
    <wen-icon-guardians-only [size]="20" class="text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-guardians-only>
    <div class="ml-1.5 text-sm font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark" i18n>
      Space Guardians Only
    </div>
  </div>
  <div class="flex" *ngIf="(data.collection$ | async)?.access === access.MEMBERS_WITH_BADGE">
    <wen-icon-members-with-badge [size]="20" class="text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-members-with-badge>
    <div class="ml-1.5 text-sm font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark" i18n>
      Space Members with Badge Only
    </div>
  </div>
  <div class="flex" *ngIf="(data.collection$ | async)?.access === access.MEMBERS_WITH_NFT_FROM_COLLECTION">
    <wen-icon-members-with-nft-from-collection [size]="20" class="text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-members-with-nft-from-collection>
    <div class="ml-1.5 text-sm font-medium w-4/5 text-foregrounds-primary dark:text-foregrounds-primary-dark" i18n>
      Must hold at least one NFT from each selected Collections
    </div>
  </div>
  <div *ngIf="(data.collection$ | async)?.onePerMemberOnly"
    class="text-sm font-medium text-foregrounds-secondary ml-7 text-foregrounds-primary dark:text-foregrounds-primary-dark" i18n>
      (One NFT per member)
  </div>

  <div *ngIf="(data.collection$ | async)?.access === access.MEMBERS_WITH_NFT_FROM_COLLECTION"
    class="flex flex-wrap mt-5">
    <div class="flex items-center cursor-pointer justify-between p-1.5 mt-2 mr-2 bg-icons-tertiary dark:bg-icons-tertiary-dark rounded-lg"
        [routerLink]="['/', 'collection', (cache.getCollection(collection) | async)?.uid]"
        *ngFor="let collection of (data.accessCollections$ | async)">
        <nz-avatar
          [nzSrc]="previewImageService.getCollectionSize((cache.getCollection(collection) | async)?.bannerUrl)"
          [nzSize]="24"
          class="mr-2.5 border-2 border-foregrounds-tertiary dark:border-foregrounds-tertiary-dark min-w-6 min-h-6"
          nzShape="circle"
        >
        </nz-avatar>
        <div class="text-sm font-medium">{{ (cache.getCollection(collection) | async)?.name }}</div>
    </div>
  </div>
</nz-card>

<nz-card class="mt-4">
  <div class="flex items-center">
    <wen-icon-tag class="text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-tag>
    <div class="ml-2.5 font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ helper.getCategory((data.collection$ | async)?.category) }}</div>
  </div>
</nz-card>

<nz-card i18n-nzTitle nzTitle="The badges you need" *ngIf="(data.accessBadges$ | async)?.length" class="mt-4 space-x-2">
  <nz-avatar
    *ngFor="let award of (data.accessBadges$ | async); trackBy: trackByUid"
    [nzSrc]="award.badge.image| ipfsBadge:filesizes.small"
    [nzSize]="64"
    class="wen-avatar-background"
    nzShape="circle"
  >
  </nz-avatar>
</nz-card>

<nz-card i18n-nzTitle nzTitle="Resources" class="mt-8" *ngIf="(data.collection$ | async)?.url || (data.collection$ | async)?.twitter || (data.collection$ | async)?.discord">
    <div class="space-y-5">
        <a *ngIf="(data.collection$ | async)?.url" target="_new"
            [href]="(data.collection$ | async)?.url"
            class="flex items-center">
            <wen-icon-link class="mr-3 text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-link>
            <div class="text-xs font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ (data.collection$ | async)?.url }}</div>
        </a>

        <a *ngIf="(data.collection$ | async)?.twitter" target="_new"
            [href]="'https://twitter.com/' + (data.collection$ | async)?.twitter"
            class="flex items-center">
            <wen-icon-twitter class="mr-3 text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-twitter>
            <div class="text-xs font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ (data.collection$ | async)?.twitter }}</div>
        </a>

        <a *ngIf="(data.collection$ | async)?.discord" target="_new"
            [href]="'https://discord.gg/' + (data.collection$ | async)?.discord"
            class="flex items-center">
            <wen-icon-discord class="mr-3 text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-discord>
            <div class="text-xs font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ (data.collection$ | async)?.discord }}</div>
        </a>
    </div>
</nz-card>

<nz-card i18n-nzTitle nzTitle="Member discounts" class="mt-4" *ngIf="(data.collection$ | async)?.discounts?.length">
  <div class="space-y-2">
    <div *ngFor="let item of helper.sortedDiscounts((data.collection$ | async)?.discounts)"
      class="flex items-center">
        <wen-icon-percentage class="mr-3 text-foregrounds-secondary dark:text-foregrounds-secondary-dark"></wen-icon-percentage>
        <div class="text-xs font-medium text-foregrounds-primary dark:text-foregrounds-primary-dark">{{ (item.amount * 100) }}% <span i18n>Discount for members with XP</span> > {{ item.xp }}</div>
    </div>
  </div>
</nz-card>

<wen-collection-mint-network *ngIf="isMintOnNetorkVisible" [isOpen]="isMintOnNetorkVisible" [collection]="(data.collection$ | async) || undefined" (wenOnClose)="isMintOnNetorkVisible = false"></wen-collection-mint-network>
