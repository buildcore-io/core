<article class="w-full bg-white rounded-2xl wen-card" [ngClass]="fullWidth ? 'w-auto h-80 lg:h-auto p-6' : 'lg:w-76 lg:h-76 p-4'"
  *ngIf="proposal">
  <a class="relative block w-full h-full text-current hover:text-current" [routerLink]="['/', this.path, proposal.uid]">
    <wen-icon-angle-left class="absolute flex rotate-180 right-6" *ngIf="fullWidth && (deviceService.isDesktop$ | async)"></wen-icon-angle-left>
    <div class="relative flex flex-col w-full" [ngClass]="fullWidth ? 'h-auto' : 'lg:h-24'">
      <h3 class="max-w-md mt-2 mb-2 text-lg font-bold lg:truncate">{{ proposal.name || proposal.uid }}</h3>
      <div class="flex items-center w-full space-x-4" *ngIf="deviceService.isDesktop$ | async">
        <nz-avatar [nzSrc]="previewImageService.getAvatarSize((space$ | async)?.avatarUrl)"
          class="border-2 border-app-gray-100 bg-bg-background min-w-10" nzShape="circle">
        </nz-avatar>
        <p nz-typography class="truncate">{{ (space$ | async)?.name || (space$ | async)?.uid}}</p>
      </div>
    </div>

    <div class="bottom-0 flex flex-col w-full lg:relative" [ngClass]="fullWidth ? 'h-auto lg:pr-16' : 'lg:h-52'">
      <div class="flex flex-col justify-end" [ngClass]="fullWidth ? 'h-auto' : 'lg:h-32'">
        <ng-container *ngFor="let q of proposal.questions">
          <!-- TODO fix 2 options percantage calc-->
          <div class="w-full" *ngIf="q.answers.length === 2">
            <nz-progress nz-tooltip [nzShowInfo]="false" nzStatus="active"
              [nzPercent]="getProgressForTwo(q.answers)[0] | number : '1.2-2'" nzStrokeLinecap="square"></nz-progress>
            <p nz-typography class="wen-two-lines">
              <span class="truncate">{{getProgressForTwo(q.answers)[0] | number : '1.2-2'}}% {{q.answers[0].text |
                truncate:[8]}}</span>
              <span class="truncate">{{getProgressForTwo(q.answers)[1] | number : '1.2-2'}}% {{q.answers[1].text |
                truncate:[8]}}</span>
            </p>
          </div>
          <!-- TODO remove chart for now-->
          <div *ngIf="q.answers.length > 2" class="flex w-full max-w-full pt-4 max-h-28">
            <!-- <apx-chart [series]="getChartSeries(q.answers)" [chart]="chartOptions.chart!"
              [labels]="getChartSeriesLabels(q.answers)" [fill]="chartOptions.fill!" [legend]="chartOptions.legend!"
              [noData]="{text: 'No Data', style: {fontSize: '16px' }}" [dataLabels]="chartOptions.dataLabels!"
              [responsive]="chartOptions.responsive!"></apx-chart> -->

            <nz-progress nz-tooltip [nzWidth]="92" nzType="circle" [nzPercent]="0" [nzShowInfo]="false"></nz-progress>

            <div class="ml-4">
              <p nz-typography class="wen-more-lines">
                <span class="truncate" [ngClass]="fullWidth ? 'max-w-md' : 'max-w-xs'">Donut graph coming SOON.</span>
              </p>
            </div>

          </div>
        </ng-container>
      </div>

      <div i18n class="flex flex-wrap mt-4 space-y-4 lg:inline-flex lg:space-y-0 lg:flex-nowrap">
        <wen-proposal-status [proposal]="proposal"></wen-proposal-status>
        <nz-tag class="flex items-center wen-status-tag bg-tag-default border-tag-default"
          *ngIf="proposal?.settings?.endDate">
          <i nz-icon class="pr-2" nzType="clock-circle"></i>
          <span>{{proposal?.settings?.endDate.toDate() | date:"short"}}</span>
        </nz-tag>
      </div>
    </div>
  </a>
</article>
