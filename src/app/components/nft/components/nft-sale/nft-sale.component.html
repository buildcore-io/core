<nz-modal *ngIf="deviceService.isDesktop$ | async"
    [(nzVisible)]="isOpen"
    nzCentered
    [nzClosable]="false"
    [nzMaskClosable]="true"
    [nzMask]="true"
    (nzOnCancel)="close()"
    [nzContent]="nftSaleModalContent"
    [nzFooter]="null"
    [nzBodyStyle]="{ padding: '0px' }"
    [nzWidth]="760"
    >
    <ng-template #nftSaleModalContent>
        <div class="bg-bg-background rounded-2xl">
            <div class="flex items-start justify-between px-6 pt-7">
                <div class="text-2xl font-bold" i18n>List Item for sale</div>
                <wen-icon-close class="cursor-pointer" (click)="close()"></wen-icon-close>
            </div>

            <ng-container *ngTemplateOutlet="content"></ng-container>
        </div>
    </ng-template>
</nz-modal>

<nz-drawer *ngIf="deviceService.isMobile$ | async"
    [nzBodyStyle]="{ overflow: 'auto', padding: '20px' }"
    [nzWidth]="'100vw'" #drawer
    [nzClosable]="false"
    [nzVisible]="isOpen">
    <div *nzDrawerContent class="relative min-h-full h-max">
        <div class="pb-4 text-3xl font-bold" i18n>List Item for sale</div>
        <button class="absolute right-0 z-10 top-1" (click)="close()">
            <wen-icon-close></wen-icon-close>
        </button>

        <ng-container *ngTemplateOutlet="content"></ng-container>
    </div>
</nz-drawer>

<ng-template #content>
    <div class="flex flex-col px-6 mt-12 lg:flex-row lg:mt-6">
        <div class="relative w-full lg:w-72 lg:w-overflow-hidden">
            <img
                *ngIf="mediaType === 'image'"
                i18n-alt
                alt="NFT image"
                [src]="nft?.media || '/assets/mocks/no_banner.jpg'"
                class="object-cover w-full h-full rounded-2xl"
            />

            <video controls class="object-cover w-full h-full rounded-2xl" *ngIf="mediaType === 'video'">
              <source [src]="nft?.media" type="video/mp4">
              Your browser does not support HTML video.
            </video>
        </div>
        <div class="mt-8 lg:ml-8 lg:mt-0 ">
            <div class="relative flex flex-col w-full h-full">
                <h3 class="mb-1 text-2xl font-bold truncate">{{ nft?.name }}</h3>
                <div class="text-xl font-medium">{{ collection?.name }}</div>

                <div class="flex items-center mt-2.5">
                    <wen-icon-crown class="mr-2.5 text-app-gray-400" [size]="20"></wen-icon-crown>
                    <div class="font-medium">{{((collection?.royaltiesFee || 0) * 100)}}% <span i18n>Royalties</span></div>
                    <wen-icon-question-circle
                        [size]="20"
                        class="ml-1.5 text-app-gray-400"
                        nz-tooltip
                        i18n-nzTooltipTitle
                        nzTooltipTitle="Royalties are automatically deducted and paid to artists."
                    ></wen-icon-question-circle>
                </div>

                <div class="px-5 py-3 mt-8 bg-white lg:mt-auto rounded-2xl w-max">
                    <div class="text-xs font-medium text-foregrounds-secondary" i18n>Current price</div>
                    <div class="flex items-center mt-2 text-lg">
                      <div class="mr-2 font-bold truncate">{{ formatBest(nft?.price || 0) }}</div>
                  </div>
                </div>
            </div>
        </div>
    </div>

    <div class="flex flex-col px-6 mt-6 mb-4 lg:flex-row lg:items-center">
        <nz-tag nzMode="checkable" class="mt-2 w-max" [nzChecked]="currentSaleType === saleType.NOT_FOR_SALE"
            (nzCheckedChange)="currentSaleType = saleType.NOT_FOR_SALE">
                <span i18n>Not for sale</span>
        </nz-tag>
        <nz-tag nzMode="checkable" class="mt-2 w-max" [nzChecked]="currentSaleType === saleType.FIXED_PRICE"
            (nzCheckedChange)="currentSaleType = saleType.FIXED_PRICE">
                <span i18n>Fixed price</span>
        </nz-tag>
        <nz-tag nzMode="checkable" class="mt-2 w-max" [nzChecked]="currentSaleType === saleType.AUCTION"
            (nzCheckedChange)="currentSaleType = saleType.AUCTION">
                <span i18n>Auction</span>
        </nz-tag>
    </div>

    <div [ngSwitch]="currentSaleType" class="w-full bg-white rounded-b-2xl">
        <wen-nft-sale-not-for-sale [nft]="nft" (wenOnUpdate)="update($event)" *ngSwitchCase="saleType.NOT_FOR_SALE"></wen-nft-sale-not-for-sale>
        <wen-nft-sale-fixed-price [nft]="nft" *ngSwitchCase="saleType.FIXED_PRICE" (wenOnUpdate)="update($event)"></wen-nft-sale-fixed-price>
        <wen-nft-sale-auction [nft]="nft"  *ngSwitchCase="saleType.AUCTION" (wenOnUpdate)="update($event)"></wen-nft-sale-auction>
    </div>
</ng-template>
